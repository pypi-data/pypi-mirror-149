image: mosaicml/pytorch_internal
git_repo: git@github.com:mosaicml/composer.git
git_branch: dev
command: >-
  pip install git+ssh://git@github.com/mosaicml/yahp.git@main

  git clone {{ git_repo }} /root/composer

  cd /root/composer

  echo 'Checking out composer branch {{ git_branch }}'

  git checkout {{ git_branch }}

  pip install --user -e .[all]

  composer -n {{ parameters['_n_gpus'] }} examples/run_mosaic_trainer.py -f /mnt/config/parameters.yaml
